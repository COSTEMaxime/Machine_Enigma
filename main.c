#include "main.h"


int main(int argc, char *argv[])
{
    int i;
    int rotor1[27] = {};
    int rotor2[27] = {};
    int rotor3[27] = {};
    int reflecteur[26] = {};
    int rotor_tempon1[27] = {4,10,12,5,11,6,3,16,21,25,13,19,14,22,24,7,23,20,18,15,0,8,1,17,2,9,0};
    int rotor_tempon2[27] = {0,9,3,10,18,8,17,20,23,1,11,7,22,19,12,2,16,6,25,13,15,24,5,21,14,4,0};
    int rotor_tempon3[27] = {1,3,5,7,9,11,2,15,17,19,23,21,25,13,24,4,8,22,6,0,10,12,20,18,16,14,0};
    int rotor_tempon4[27] = {4,18,14,21,15,25,9,0,24,16,20,8,17,7,23,11,13,5,19,6,10,3,2,12,22,1,0};
    int rotor_tempon5[27] = {21,25,1,17,6,8,19,24,20,15,18,3,13,7,11,23,0,22,12,9,16,14,5,4,2,10,0};
    int rotor_tempon6[27] = {9,15,6,21,14,20,12,5,24,16,1,4,13,7,25,17,3,10,0,18,23,11,8,2,19,22,0};
    int rotor_tempon7[27] = {13,25,9,7,6,17,2,23,12,24,18,22,1,14,20,5,0,8,21,11,15,4,10,16,3,19,0};
    int rotor_tempon8[27] = {5,10,16,7,19,11,23,14,2,1,9,18,15,3,25,17,0,12,4,22,13,8,20,24,6,21,0};
    int reflecteur_tempon1[26] = {24,17,20,7,16,18,11,3,15,23,13,6,14,10,12,8,4,1,5,25,2,22,21,9,0,19};
    int reflecteur_tempon2[26] = {5,13,15,9,8,0,14,24,4,3,17,25,23,22,6,2,19,10,20,16,18,1,13,12,7,11};
    int reflecteur_tempon3[26] = {4,13,10,16,0,20,24,22,9,8,2,14,15,1,11,12,3,23,25,21,5,19,7,17,6,18};
    int reflecteur_tempon4[26] = {17,3,14,1,9,13,19,10,21,4,7,12,11,5,2,22,25,0,23,6,24,8,15,18,20,18};
    char chaine[1000] = {};
    char lettre = 0;

    printf("0111011111101111001011000001110110100100100110001011111011011001101011000000001001111100110110001100101110101110110101111001011111011100011111100011011110011110010110111001000010011000100010101110100010000111101100111000010110101010100100110011111101001011010000111000010100101100110010010111000001101101011011000010010110101000000111111101010110111010110011101010100010001010000011110011110000000101101111011000010011100001001111011000101001101111000011010101010111001000111001100101011000100101101010000101110000000110011010010100011111111000111111100010001011100001111101100110000110000001100101001010101000001111101101111100011110111001010110101111001110010100110110000101110110001101111000000100011000101000010100100110001100101001110000011011110100000001000010000011001001101111001100001110000010       1100   011101  0010 001110         1101   011111000   1101000   001010011  011001100  1  0111  1100 1000  1000001011010 0  0101011 0  000000  0  10011001       1011  11  100  1111 101  01001010110001 11  11000 11  00000  010  0000000  101110111  111  11  1101 110  01101011  1011 001  110  11  1001  1010   001111  101100001  00010    0001 0010  1111111  1011 1010    0000  101  101001   11101        000  001001   0010 111000         1011 10010  11111  111 10100111  001000001000100010011001101000011101100111101100110100111011010100000110001100000111100000101110010001000110000101111101101011110001100110001101001100000001101111011101000101110001001111001100010111111001111000111111011000101001011001101100111101100011100110010010011000000111111110010000110101110100100000001000111100100000011010110010111001100011001010101101101000111111011001111101000011000011100001101011110100110000010111101011000011100011010000111011101001010110101000101011011111101110001010010000001001000110110000110010110111011110100110100100101000100110010110001100100101110111101001011110100100000101101100100011001011001100011111111101001010100011001101001101101111111010010100111010101001000101100001111111000");
    printf("\n\n\n\n\nBonjour, bienvenue dans le programme Enigma.\nCe programme permet de crypter et de decrypter des donnees.\nCi-dessous vous pourrez parametrer l'emulateur, ce qui augmentera la securite devotre transmission.\nSelectionnez quels rotors et quel reflecteur utiliser pour la machine.\nLe rotor 1 est celui de droite, le 2 celui du milieu et le 3 celui de gauche.\nLes rotors sont numerotes de 1 a 8.\nLes reflecteurs sont notes de 1 a 4.\nVeuillez ne pas selectionner 2 fois le meme rotor.\n");
    selectRotor(rotor1, 1, rotor_tempon1, rotor_tempon2, rotor_tempon3, rotor_tempon4, rotor_tempon5, rotor_tempon6, rotor_tempon7, rotor_tempon8);
    selectRotor(rotor2, 2, rotor_tempon1, rotor_tempon2, rotor_tempon3, rotor_tempon4, rotor_tempon5, rotor_tempon6, rotor_tempon7, rotor_tempon8);
    selectRotor(rotor3, 3, rotor_tempon1, rotor_tempon2, rotor_tempon3, rotor_tempon4, rotor_tempon5, rotor_tempon6, rotor_tempon7, rotor_tempon8);
    selectReflecteur(reflecteur, reflecteur_tempon1, reflecteur_tempon2, reflecteur_tempon3, reflecteur_tempon4);
    setupRotor(rotor1, 1);
    setupRotor(rotor2, 2);
    setupRotor(rotor3, 3);

    printf("\nEntrez votre message :\n");
    lire(chaine, 1000);

    for(i = 0; i < strlen(chaine); i++)
    {
        if(chaine[i] != ' ')
        {
            chaine[i] = toupper(chaine[i]);
            lettre = chaine[i] - 65;
            lettre = rotor3[lettre % 26];
            lettre = rotor2[lettre % 26];
            lettre = rotor1[lettre % 26];
            lettre = reflecteur[lettre % 26];
            lettre = inverse(rotor1, lettre) % 26;
            lettre = inverse(rotor2, lettre) % 26;
            lettre = inverse(rotor3, lettre) % 26;
            Rotor(rotor1, rotor2, rotor3);
            chaine[i] = lettre + 65;
        }
    }
    printf("\nVoici votre message code/decode :\n");
    printf("%s\n", chaine);

    return 0;
}
